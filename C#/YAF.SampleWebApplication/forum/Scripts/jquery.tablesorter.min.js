(function(n){n.extend({tablesorter:new function(){function benchmark(n,t){r(n+","+((new Date).getTime()-t.getTime())+"ms")}function r(n){typeof console!="undefined"&&typeof console.debug!="undefined"?console.log(n):alert(n)}function o(t,i){var o,e,u,f;if(t.config.debug&&(o=""),t.tBodies.length!=0){if(e=t.tBodies[0].rows,e[0]){var h=[],c=e[0].cells,l=c.length;for(u=0;u<l;u++)f=!1,n.metadata&&n(i[u]).metadata()&&n(i[u]).metadata().sorter?f=s(n(i[u]).metadata().sorter):t.config.headers[u]&&t.config.headers[u].sorter&&(f=s(t.config.headers[u].sorter)),f||(f=y(t,e,-1,u)),t.config.debug&&(o+="column:"+u+" parser:"+f.id+"\n"),h.push(f)}return t.config.debug&&r(o),h}}function y(n,i,u,f){for(var c=t.length,o=!1,s=!1,h=!0,e;s==""&&h;)u++,i[u]?(o=p(i,u,f),s=w(n.config,o),n.config.debug&&r("Checking if value was empty on row:"+u)):h=!1;for(e=1;e<c;e++)if(t[e].is(s,n,o))return t[e];return t[0]}function p(n,t,i){return n[t].cells[i]}function w(t,i){return n.trim(u(t,i))}function s(n){for(var r=t.length,i=0;i<r;i++)if(t[i].id.toLowerCase()==n.toLowerCase())return t[i];return!1}function h(t){var s,o,r,e,f;t.config.debug&&(s=new Date);var h=t.tBodies[0]&&t.tBodies[0].rows.length||0,c=t.tBodies[0].rows[0]&&t.tBodies[0].rows[0].cells.length||0,l=t.config.parsers,i={row:[],normalized:[]};for(o=0;o<h;++o){if(r=n(t.tBodies[0].rows[o]),e=[],r.hasClass(t.config.cssChildRow)){i.row[i.row.length-1]=i.row[i.row.length-1].add(r);continue}for(i.row.push(r),f=0;f<c;++f)e.push(l[f].format(u(t.config,r[0].cells[f]),t,r[0].cells[f]));e.push(i.normalized.length);i.normalized.push(e);e=null}return t.config.debug&&benchmark("Building cache for "+h+" rows:",s),i}function u(t,i){return i?(t.supportsTextContent||(t.supportsTextContent=i.textContent||!1),t.textExtraction=="simple"?t.supportsTextContent?i.textContent:i.childNodes[0]&&i.childNodes[0].hasChildNodes()?i.childNodes[0].innerHTML:i.innerHTML:typeof t.textExtraction=="function"?t.textExtraction(i):n(i).text()):""}function f(t,i){var c,r,u,a,f;t.config.debug&&(c=new Date);var l=i,o=l.row,s=l.normalized,v=s.length,y=s[0].length-1,p=n(t.tBodies[0]),h=[];for(r=0;r<v;r++)if(u=s[r][y],h.push(o[u]),!t.config.appender)for(a=o[u].length,f=0;f<a;f++)p[0].appendChild(o[u][f]);t.config.appender&&t.config.appender(t,h);h=null;t.config.debug&&benchmark("Rebuilt table:",c);e(t);setTimeout(function(){n(t).trigger("sortEnd")},0)}function b(t){var i,f,u;return t.config.debug&&(i=new Date),f=n.metadata?!0:!1,u=k(t),$tableHeaders=n(t.config.selectorHeaders,t).each(function(i){if(this.column=u[this.parentNode.rowIndex+"-"+this.cellIndex],this.order=tt(t.config.sortInitialOrder),this.count=this.order,(g(this)||nt(t,i))&&(this.sortDisabled=!0),c(t,i)&&(this.order=this.lockedOrder=c(t,i)),!this.sortDisabled){var r=n(this).addClass(t.config.cssHeader);t.config.onRenderHeader&&t.config.onRenderHeader.apply(r)}t.config.headerList[i]=this}),t.config.debug&&(benchmark("Built headers:",i),r($tableHeaders)),$tableHeaders}function k(n){for(var h,u,t,a,o,i=[],c={},v=n.getElementsByTagName("THEAD")[0],l=v.getElementsByTagName("TR"),s=0;s<l.length;s++)for(h=l[s].cells,u=0;u<h.length;u++){var f=h[u],r=f.parentNode.rowIndex,y=r+"-"+f.cellIndex,p=f.rowSpan||1,w=f.colSpan||1,e;for(typeof i[r]=="undefined"&&(i[r]=[]),t=0;t<i[r].length+1;t++)if(typeof i[r][t]=="undefined"){e=t;break}for(c[y]=e,t=r;t<r+p;t++)for(typeof i[t]=="undefined"&&(i[t]=[]),a=i[t],o=e;o<e+w;o++)a[o]="x"}return c}function g(t){return n.metadata&&n(t).metadata().sorter===!1?!0:!1}function nt(n,t){return n.config.headers[t]&&n.config.headers[t].sorter===!1?!0:!1}function c(n,t){return n.config.headers[t]&&n.config.headers[t].lockedOrder?n.config.headers[t].lockedOrder:!1}function e(n){for(var i=n.config.widgets,r=i.length,t=0;t<r;t++)l(i[t]).format(n)}function l(n){for(var r=i.length,t=0;t<r;t++)if(i[t].id.toLowerCase()==n.toLowerCase())return i[t]}function tt(n){return typeof n!="Number"?n.toLowerCase()=="desc"?1:0:n==1?1:0}function it(n,t){for(var r=t.length,i=0;i<r;i++)if(t[i][0]==n)return!0;return!1}function a(t,i,r,u){var e,o,f;for(i.removeClass(u[0]).removeClass(u[1]),e=[],i.each(function(){this.sortDisabled||(e[this.column]=n(this))}),o=r.length,f=0;f<o;f++)e[r[f][0]].addClass(u[r[f][1]])}function rt(t){var r=t.config,i;r.widthFixed&&(i=n("<colgroup>"),n("tr:first td",t.tBodies[0]).each(function(){i.append(n("<col>").css("width",n(this).width()))}),n(t).prepend(i))}function ut(n,t){for(var r,u,f=n.config,e=t.length,i=0;i<e;i++)r=t[i],u=f.headerList[r[0]],u.count=r[1],u.count++}function v(table,sortList,cache){var sortTime,dynamicExp,l,orgOrderCol,i;for(table.config.debug&&(sortTime=new Date),dynamicExp="var sortWrapper = function(a,b) {",l=sortList.length,i=0;i<l;i++){var c=sortList[i][0],order=sortList[i][1],s=table.config.parsers[c].type=="text"?order==0?makeSortFunction("text","asc",c):makeSortFunction("text","desc",c):order==0?makeSortFunction("numeric","asc",c):makeSortFunction("numeric","desc",c),e="e"+i;dynamicExp+="var "+e+" = "+s;dynamicExp+="if("+e+") { return "+e+"; } ";dynamicExp+="else { "}for(orgOrderCol=cache.normalized[0].length-1,dynamicExp+="return a["+orgOrderCol+"]-b["+orgOrderCol+"];",i=0;i<l;i++)dynamicExp+="}; ";return dynamicExp+="return 0; ",dynamicExp+="}; ",table.config.debug&&benchmark("Evaling expression:"+dynamicExp,new Date),eval(dynamicExp),cache.normalized.sort(sortWrapper),table.config.debug&&benchmark("Sorting on "+sortList.toString()+" and dir "+order+" time:",sortTime),cache}function makeSortFunction(n,t,i){var r="a["+i+"]",u="b["+i+"]";return n=="text"&&t=="asc"?"("+r+" == "+u+" ? 0 : ("+r+" === null ? Number.POSITIVE_INFINITY : ("+u+" === null ? Number.NEGATIVE_INFINITY : ("+r+" < "+u+") ? -1 : 1 )));":n=="text"&&t=="desc"?"("+r+" == "+u+" ? 0 : ("+r+" === null ? Number.POSITIVE_INFINITY : ("+u+" === null ? Number.NEGATIVE_INFINITY : ("+u+" < "+r+") ? -1 : 1 )));":n=="numeric"&&t=="asc"?"("+r+" === null && "+u+" === null) ? 0 :("+r+" === null ? Number.POSITIVE_INFINITY : ("+u+" === null ? Number.NEGATIVE_INFINITY : "+r+" - "+u+"));":n=="numeric"&&t=="desc"?"("+r+" === null && "+u+" === null) ? 0 :("+r+" === null ? Number.POSITIVE_INFINITY : ("+u+" === null ? Number.NEGATIVE_INFINITY : "+u+" - "+r+"));":void 0}var t=[],i=[];this.defaults={cssHeader:"header",cssAsc:"headerSortUp",cssDesc:"headerSortDown",cssChildRow:"expand-child",sortInitialOrder:"asc",sortMultiSortKey:"shiftKey",sortForce:null,sortAppend:null,sortLocaleCompare:!0,textExtraction:"simple",parsers:{},widgets:[],widgetZebra:{css:["even","odd"]},headers:{},widthFixed:!1,cancelSelection:!0,sortList:[],headerList:[],dateFormat:"us",decimal:"/.|,/g",onRenderHeader:null,selectorHeaders:"thead th",debug:!1};this.benchmark=benchmark;this.construct=function(t){return this.each(function(){var r,s,c,i,p,y;this.tHead&&this.tBodies&&(p=0,this.config={},i=n.extend(this.config,n.tablesorter.defaults,t),r=n(this),n.data(this,"tablesorter",i),s=b(this),this.config.parsers=o(this,s),c=h(this),y=[i.cssDesc,i.cssAsc],rt(this),s.click(function(t){var p=r[0].tBodies[0]&&r[0].tBodies[0].rows.length||0,w,e,h,u,o,l;if(!this.sortDisabled&&p>0){if(r.trigger("sortStart"),w=n(this),e=this.column,this.order=this.count++%2,this.lockedOrder&&(this.order=this.lockedOrder),t[i.sortMultiSortKey])if(it(e,i.sortList))for(u=0;u<i.sortList.length;u++)o=i.sortList[u],l=i.headerList[o[0]],o[0]==e&&(l.count=o[1],l.count++,o[1]=l.count%2);else i.sortList.push([e,this.order]);else{if(i.sortList=[],i.sortForce!=null)for(h=i.sortForce,u=0;u<h.length;u++)h[u][0]!=e&&i.sortList.push(h[u]);i.sortList.push([e,this.order])}return setTimeout(function(){a(r[0],s,i.sortList,y);f(r[0],v(r[0],i.sortList,c))},1),!1}}).mousedown(function(){if(i.cancelSelection)return this.onselectstart=function(){return!1},!1}),r.bind("update",function(){var n=this;setTimeout(function(){n.config.parsers=o(n,s);c=h(n)},1)}).bind("updateCell",function(n,t){var r=this.config,i=[t.parentNode.rowIndex-1,t.cellIndex];c.normalized[i[0]][i[1]]=r.parsers[i[1]].format(u(r,t),t)}).bind("sorton",function(t,r){n(this).trigger("sortStart");i.sortList=r;var u=i.sortList;ut(this,u);a(this,s,u,y);f(this,v(this,u,c))}).bind("appendCache",function(){f(this,c)}).bind("applyWidgetId",function(n,t){l(t).format(this)}).bind("applyWidgets",function(){e(this)}),n.metadata&&n(this).metadata()&&n(this).metadata().sortlist&&(i.sortList=n(this).metadata().sortlist),i.sortList.length>0&&r.trigger("sorton",[i.sortList]),e(this))})};this.addParser=function(n){for(var u=t.length,r=!0,i=0;i<u;i++)t[i].id.toLowerCase()==n.id.toLowerCase()&&(r=!1);r&&t.push(n)};this.addWidget=function(n){i.push(n)};this.formatFloat=function(n){var t=parseFloat(n);return isNaN(t)?0:t};this.formatInt=function(n){var t=parseInt(n);return isNaN(t)?0:t};this.isDigit=function(t){return/^[-+]?\d*$/.test(n.trim(t.replace(/[,.']/g,"")))};this.clearTableBody=function(n){if(navigator.userAgent.match("MSIE")){function t(){while(this.firstChild)this.removeChild(this.firstChild)}t.apply(n.tBodies[0])}else n.tBodies[0].innerHTML=""}}});n.fn.extend({tablesorter:n.tablesorter.construct});var t=n.tablesorter;t.addParser({id:"text",is:function(){return!0},format:function(t){return n.trim(t.toLocaleLowerCase())},type:"text"});t.addParser({id:"digit",is:function(t,i){var r=i.config;return n.tablesorter.isDigit(t,r)},format:function(t){return n.tablesorter.formatFloat(t)},type:"numeric"});t.addParser({id:"currency",is:function(n){return/^[£$€?.]/.test(n)},format:function(t){return n.tablesorter.formatFloat(t.replace(new RegExp(/[£$€]/g),""))},type:"numeric"});t.addParser({id:"ipAddress",is:function(n){return/^\d{2,3}[\.]\d{2,3}[\.]\d{2,3}[\.]\d{2,3}$/.test(n)},format:function(t){for(var i,u=t.split("."),f="",e=u.length,r=0;r<e;r++)i=u[r],f+=i.length==2?"0"+i:i;return n.tablesorter.formatFloat(f)},type:"numeric"});t.addParser({id:"url",is:function(n){return/^(https?|ftp|file):\/\/$/.test(n)},format:function(n){return jQuery.trim(n.replace(new RegExp(/(https?|ftp|file):\/\//),""))},type:"text"});t.addParser({id:"isoDate",is:function(n){return/^\d{4}[\/-]\d{1,2}[\/-]\d{1,2}$/.test(n)},format:function(t){return n.tablesorter.formatFloat(t!=""?new Date(t.replace(new RegExp(/-/g),"/")).getTime():"0")},type:"numeric"});t.addParser({id:"percent",is:function(t){return/\%$/.test(n.trim(t))},format:function(t){return n.tablesorter.formatFloat(t.replace(new RegExp(/%/g),""))},type:"numeric"});t.addParser({id:"usLongDate",is:function(n){return n.match(new RegExp(/^[A-Za-z]{3,10}\.? [0-9]{1,2}, ([0-9]{4}|'?[0-9]{2}) (([0-2]?[0-9]:[0-5][0-9])|([0-1]?[0-9]:[0-5][0-9]\s(AM|PM)))$/))},format:function(t){return n.tablesorter.formatFloat(new Date(t).getTime())},type:"numeric"});t.addParser({id:"shortDate",is:function(n){return/\d{1,2}[\/\-]\d{1,2}[\/\-]\d{2,4}/.test(n)},format:function(t,i){var r=i.config;return t=t.replace(/\-/g,"/"),r.dateFormat=="us"?t=t.replace(/(\d{1,2})[\/\-](\d{1,2})[\/\-](\d{4})/,"$3/$1/$2"):r.dateFormat=="uk"?t=t.replace(/(\d{1,2})[\/\-](\d{1,2})[\/\-](\d{4})/,"$3/$2/$1"):(r.dateFormat=="dd/mm/yy"||r.dateFormat=="dd-mm-yy")&&(t=t.replace(/(\d{1,2})[\/\-](\d{1,2})[\/\-](\d{2})/,"$1/$2/$3")),n.tablesorter.formatFloat(new Date(t).getTime())},type:"numeric"});t.addParser({id:"time",is:function(n){return/^(([0-2]?[0-9]:[0-5][0-9])|([0-1]?[0-9]:[0-5][0-9]\s(am|pm)))$/.test(n)},format:function(t){return n.tablesorter.formatFloat(new Date("2000/01/01 "+t).getTime())},type:"numeric"});t.addParser({id:"metadata",is:function(){return!1},format:function(t,i,r){var u=i.config,f=u.parserMetadataName?u.parserMetadataName:"sortValue";return n(r).metadata()[f]},type:"numeric"});t.addWidget({id:"zebra",format:function(t){var f,i,r,u;t.config.debug&&(f=new Date);r=-1;n("tr:visible",t.tBodies[0]).each(function(){i=n(this);i.hasClass(t.config.cssChildRow)||r++;u=r%2==0;i.removeClass(t.config.widgetZebra.css[u?0:1]).addClass(t.config.widgetZebra.css[u?1:0])});t.config.debug&&n.tablesorter.benchmark("Applying Zebra widget",f)}})})(jQuery);